<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>AppFog &mdash; Documentation StatsMix</title> 

		<link rel="stylesheet" href="http://appfog.com/css/style.css">
		<link href="/css/prettify.css" type="text/css" rel="stylesheet" />
		<link href="/css/table.css" rel="stylesheet">
		<link href="/css/docs.css" rel="stylesheet">
		<!-- typekit -->
		<script type="text/javascript" src="http://use.typekit.com/abw3xjt.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
				
		<!-- css -->

		<!-- modernizr -->
		<script src="http://appfog.com/js/libs/modernizr-2.5.3.min.js"></script>

		<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
		<script type="text/javascript" src="/js/bootstrap.js"></script>

		<!--  -->
		<link rel="icon" type="image/png" href="http://appfog.com/favicon.ico" />
		
		<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-16856502-8']);
      _gaq.push(['_setDomainName', '.appfog.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
		
	</head>
	<body id="blog" onload="prettyPrint()">
	<div id="header">
		<div class="container">
			<a href="http://appfog.com/" id="app_fog"><img src="http://appfog.com/img/app-fog.png" width="189" height="47" alt="App Fog"></a>
			<ul id="main_nav">
				<li id="nproducts">
					<a href="#" title="Products" class="parent"><span>Products</span></a>
					<ul>
						<li><a href="http://appfog.com/products/appfog">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog">PHP Fog</a></li>
					</ul>
				</li>
				<li id="npricing">
					<a href="#" title="Pricing" class="parent"><span>Pricing</span></a>
					<ul>
						<li><a href="https://console.appfog.com/pricing">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog/pricing/">PhpFog</a></li>
					</ul>
				</li>
				<li id="nshowcase"><a href="http://appfog.com/showcase/" title="Showcase">Showcase</a></li>
				<li id="nabout"><a href="http://appfog.com/about/" title="About">About</a></li>
				<li id="nsupport"><a href="http://appfog.com/support/" title="Support">Support</a></li>
				<li id="nblog"><a href="http://blog.appfog.com/" title="Blog">Blog</a></li>

				<li id="nlogin">
						  <a href="#" title="Log In" class="btn gray">Log In <i class="icon-chevron-down"></i></a>
						  <form id="log_in_form" class="dropdown">
							<div class="container">
							  <!-- <div class="half">
								<div class="radio_btn" id="log_in_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_php_fog" checked>
								  </span>
								  <label for="log_in_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="log_in_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_appfog">
								  </span>
								  <label for="log_in_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
							<!-- <hr> -->

							<!-- <div class="container appfog">
							  <input type="email" name="email" value="" id="appfog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="appfog_log_in_password" placeholder="Password" class="text">
							</div>
							
							<div class="container php_fog">
							  <input type="email" name="email" value="" id="php_fog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="php_fog_log_in_password" placeholder="Password" class="text">
							</div> -->
										

										
							<!-- <div class="container">  
							  <div class="half">
								<div class="checkbox">
								  <span class="active">
									<input type="checkbox" name="remember_me" value="" id="log_in_remember_me" checked>
								  </span>
								</div>
								<label for="log_in_remember_me" class="remember_me">Remember Me</label>
							  </div>

							  <div class="half forgot_password">
								<a href="#">Forgot Password?</a>
							  </div>
							</div> -->
										<a href="https://phpfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to PHP Fog</a>
										<hr>
										<a href="https://console.appfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to AppFog</a>
									</form>
								</li>
								<li id="nsignup">
									<a href="#" title="Sign Up" class="btn bright_green">Sign Up <i class="icon-chevron-down"></i></a>
									<form id="sign_up_form" class="dropdown">
							<!-- <div class="container">
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_php_fog" checked>
								  </span>
								  <label for="sign_up_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_appfog">
								  </span>
								  <label for="sign_up_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
										<!-- <hr>
													
													<div class="container php_fog">
													  <input type="email" name="email" value="" id="sign_up_php_fog_email" placeholder="Email" class="text">
													  <input type="password" name="password" value="" id="sign_up_password" placeholder="Password" class="text">
													  <input type="password" name="password_confirmation" value="" id="sign_up_password_confirmation" placeholder="Password Confirmation" class="text">
													</div>
													
													<div class="container appfog">
													  <input type="email" name="email" value="" id="sign_up_appfog_email" placeholder="Email" class="text">
													</div> -->
										
										<a href="https://phpfog.com/signup" class="btn bright_green submit" style="font-size: 13px;">Register for PHP Fog</a>
										<hr>
										<a href="http://appfog.com/signup.php" class="btn bright_green submit" style="font-size: 13px;">Register for AppFog</a>
									</form>
								</li>

			</ul>
		</div> 
	</div>
	<div id="main_content">
		<div class='container'>

			
			<div id="top_bar" class="row gray_blue margin_bottom">
				<div class="span12">
					<a href="/"><h1 class="title">AppFog Docs</h1></a>
					<ul id="docs_nav">
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="/add-ons">Add-ons</a></li>
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="#">StatsMix</a></li>
					</ul>
					<ul id="secondary_nav">
						<li><a href="http://docs.phpfog.com">PHP Fog Docs</a></li>
					</ul>
				</div>

			</div>
			
					


			<div id="content" class="row white">
				<div class="span8 main_content">
					<div class="row entries">
	<div class="span8">
		<div class="row">
			<div class="span8">
				<h1>StatsMix</h1>
				<p><a href="http://www.statsmix.com/">StatsMix</a> makes it easy to track, chart, and share application and business metrics. </p>

<p>Use StatsMix to:</p>

<ul>
  <li>Log every time a particular event happens (such as a user creating a new blog post)</li>
  <li>View a real-time chart of these application events in StatsMix’s web UI</li>
  <li>Share the charts with users inside and outside your organization</li>
  <li>Create and share custom dashboards that aggregate multiple metrics together
    <ul>
      <li><a href="http://www.statsmix.com/d/0e788d59208900e7e3bc">Example dashboard</a></li>
      <li><a href="http://www.statsmix.com/example-embedded">Example embedded dashboard</a></li>
    </ul>
  </li>
</ul>

<h3 id="install-statsmix">Install StatsMix</h3>

<p>In the “Add-ons” tab in your app console click “Install” for the StatsMix add-on. That’s it!</p>

<p>Next, set up your app to start using the cache. We have documentation for the following languages and frameworks: </p>

<ul>
  <li><a href="#rails">Rails</a></li>
  <li><a href="#php">PHP</a></li>
</ul>

<p>For other languages and frameworks, check out <a href="http://www.statsmix.com/developers/code_libraries">this page</a>.</p>

<p>For the StatsMix API, go <a href="http://www.statsmix.com/developers">here</a>.</p>

<h1 id="rails">Rails</h1>

<p>First, install the StatsMix gem:</p>

<pre class="prettyprint"><code>$ gem install statsmix
</code></pre>

<p>Next, configure the gem according to your version of Rails:</p>

<h3 id="rails-2">Rails 2</h3>

<p>Add the following to <code>config/environment.rb</code>, then restart the server: </p>

<pre class="prettyprint"><code>$ config.gem 'statsmix'
</code></pre>

<h3 id="rails-3">Rails 3</h3>

<p>Add the following to your Gemfile, then restart the server: </p>

<pre class="prettyprint"><code>$ gem 'statsmix'
</code></pre>

<h1 id="your-api-key">Your API Key</h1>

<p>AppFog keeps your StatsMix API key in an environment variable called <code>STATSMIX_URL</code>, which you can retrieve using the command <code>ENV['STATSMIX_URL']</code>. Populate your API key for the StatsMix gem with this: </p>

<pre class="prettyprint"><code>$ StatsMix.api_key = ENV['STATSMIX_URL']
</code></pre>

<h1 id="using-statsmix-to-track-events">Using StatsMix to Track Events</h1>

<p>Any time you want to track an event in your app, simply call:</p>

<pre class="prettyprint"><code>StatsMix.track(name_of_metric, value = 1, options = {})
</code></pre>

<p>If a metric with that name doesn’t exist in your account, StatsMix will create one automatically. If the profile isn’t set, the metric will use the first <code>profile_id</code> created in your account. (Developer, Basic, and Standard plans only have one profile.)</p>

<h3 id="examples">Examples</h3>

<p>Track every time a new blog post is created:</p>

<pre class="prettyprint"><code># create a stat with the value 1 (default) for the metric called "Blog Posts"
StatsMix.track("Blog Posts")
</code></pre>

<p>Count the number of new user accounts in the last 24 hours (i.e. run daily in a daily rake task):</p>

<pre class="prettyprint"><code>count = User.count(:conditions =&gt; ["created_at &gt;= ?", 24.hours.ago]) 
# create a stat with the value count for the metric called "Daily New Users"
StatsMix.track("Daily New Users", count)
</code></pre>

<h1 id="adding-metadata">Adding Metadata</h1>

<p>You can optionally “tag” your data with metadata in the <code>:meta</code> option. For example, if you have a file upload utility and want to track what kinds of files you are receiving:</p>

<pre class="prettyprint"><code># a user just uploaded a PDF file; track the type of file using metadata
StatsMix.track("File Uploads", 1, {:meta =&gt; {"file type" =&gt; "PDF"}})
</code></pre>

<p>You can include multiple key-value pairs in the same stat:</p>

<pre class="prettyprint"><code>StatsMix.track("File Uploads", 1, {:meta =&gt; {"file type" =&gt; "PDF", "size" =&gt; "1 mb", "country of origin" =&gt; "Absurdistan"}})
</code></pre>

<h1 id="adding-your-own-identifier">Adding Your Own Identifier</h1>

<p>If you need the ability to update a stat after the fact, you can pass in a unique identifier <code>ref_id</code> (scoped to that metric).</p>

<p>For example, perhaps you want to update the number of users every hour instead of every day. If you pass in the date as <code>ref_id</code>, StatsMix will check whether a stat with that <code>ref_id</code> already exists for that metric. If found, StatsMix will update instead of inserting.</p>

<pre class="prettyprint"><code>count = User.count(:conditions =&gt; ["created_at &gt;= ?", Time.now.strftime("%Y-%m-%d")]) 
# create/update a stat using today"s date as the unique identifier
StatsMix.track("Daily New Users", count, {:ref_id =&gt; Time.now.strftime("%Y-%m-%d")})
</code></pre>

<h3 id="additional-options">Additional Options</h3>

<p>If you’d like to change the timestamp of a stat, pass in the parameter <code>generated_at</code>.</p>

<pre class="prettyprint"><code># backdate the stat to yesterday
StatsMix.track("Blog Posts", 1, {:generated_at =&gt; 1.days.ago})
</code></pre>

<p>Higher level StatsMix accounts can have additional profiles. A profile can be described as a grouping or “bucket” of metrics. For example, an agency may want to create a profile for each customer.</p>

<p>If you are tracking metrics with the same name in two different profiles, you must specify which profile to use with <code>profile_id</code>. (If you don’t specify <code>profile_id</code>, StatsMix will default to the first profile in your account.)</p>

<pre class="prettyprint"><code>StatsMix.track("Blog Posts", 1, {:profile_id =&gt; 789})
</code></pre>

<p>You can find the profile ID in StatsMix by creating a metric and looking at the API Details under Code Snippets in the Data &amp; API section. (It will also be in the URL as /<code>profiles/123/metrics/456</code> - in this case the profile id is 123.)</p>

<h3 id="limitations">Limitations</h3>

<p>If you hit a plan level limit (i.e. you go over the number of API requests available to your account), the API will return a 403 Forbidden error and an explanation.</p>

<p>The number of API requests and profiles you can create is based on the type of account you have. For example, Standard plans are limited to 300,000 API requests per month. You can see the current options on StatsMix’s <a href="http://www.statsmix.com/home/plans">pricing page</a>.</p>

<h3 id="local-setup">Local Setup</h3>

<p>When running StatsMix in development, you can tell StatsMix to either ignore calls to it altogether or funnel them all into a single test metric.</p>

<p>For ignoring calls altogether, just put the following in a configuration file such as environment.rb or an initializer:</p>

<pre class="prettyprint"><code>StatsMix.ignore = true
</code></pre>

<p>For logging to a test metric, add this instead:</p>

<pre class="prettyprint"><code>StatsMix.test_metric_name = "My Test Metric"
</code></pre>

<p>This routes all <code>StatsMix.track</code> calls to “My Test Metric” regardless of the metric name passed.</p>

<p>Note: If StatsMix.ignore is set, then the test metric will not be used unless StatsMix.ignore is first reset to false.</p>

<h1 id="php">PHP</h1>

<p>You can get 98% of our functionality by copying &amp; pasting the examples below. </p>

<p>The basic pattern:</p>

<pre class="prettyprint linenums"><code>require "StatsMix.php";
StatsMix::set_api_key(getenv("STATSMIX_URL");
StatsMix::track($name_of_metric,$value = 1,$options = array());
</code></pre>

<p>Push a stat with the value 1 (default) to a metric called “My First Metric”:</p>

<pre><code>StatsMix::track("My First Metric");
</code></pre>

<p>Push the value 20:</p>

<pre><code>StatsMix::track("My First Metric",20);
</code></pre>

<p>Add metadata via the “meta” option in <code>$options</code> - you can use this to add granularity to your stats. This example tracks file uploads by file type.</p>

<pre class="prettyprint"><code>StatsMix::track("File Uploads", 1, array('meta' =&gt; array("file type" =&gt; "PDF")));
</code></pre>

<p>If you need the ability to update a stat after the fact (i.e. you’re updating the same stat several times a day),  you can pass in a unique identifier called <code>ref_id</code>, which is scoped to the metric (so you can use the same identifier across metrics) This example uses the current date (in UTC time) for <code>ref_id</code>.</p>

<pre class="prettyprint"><code>StatsMix::track("File Uploads", 1, array('ref_id' =&gt; gmstrftime('%Y-%m-%d'), 'meta' =&gt; array("file type" =&gt; "PDF")));
</code></pre>

<p>If you need to timestamp the stat for something other than now, pass in a UTC datetime with the key <code>generated_at</code></p>

<pre class="prettyprint"><code>StatsMix::track("File Uploads", 1, array('generated_at' =&gt; gmstrftime('%Y-%m-%d %H:%I:%S',strtotime('yesterday'))));
</code></pre>

<p>To turn off tracking in your development environment:</p>

<pre class="prettyprint"><code>StatsMix::set_ignore(true);
</code></pre>

<p>To redirect all stats in dev environment to a test metric:</p>

<pre class="prettyprint"><code>StatsMix::set_test_metric_name("My Test Metric");
</code></pre>

<p>If you have multiple profiles in your account, specify which one via <code>profile_id</code>:</p>

<pre class="prettyprint"><code>StatsMix::track("metric name that may be in multiple profiles", 1, array('profile_id' =&gt; "PROFILE_ID"));
</code></pre>

<p>To create metrics and stats using a more OO approach, check out the classes <strong>SmMetric</strong> and <strong>SmStat</strong> in StatsMix.php. Using them you can do things like this:</p>

<p>Create a metric:</p>

<pre class="prettyprint linenums"><code>$metric = new SmMetric;
$metric-&gt;name = "My Test Metric";
$metric-&gt;save();
if($metric-&gt;error){
	echo "&lt;p&gt;Error: {$metric-&gt;error}&lt;/p&gt;";
}
//view the xml response:
echo $metric-&gt;get_response();
</code></pre>

<h3 id="more-documentation">More Documentation</h3>

<p>The StatsMix PHP Library supports all the methods documented <a href="http://www.statsmix.com/developers/documentation">here</a>.</p>

<h3 id="contributing-to-statsmix">Contributing to statsmix</h3>

<p>Check out <a href="https://github.com/derekscruggs/PHP-library-for-StatsMix-API">this GitHub repo</a> to contribute.</p>

<h3 id="copyright">Copyright</h3>

<p>Copyright © 2011 StatsMix, Inc. See <a href="https://github.com/tmarkiewicz/statsmix/blob/master/LICENSE.txt">LICENSE.txt</a> for further details.</p>


			</div>
		</div>
	</div>
</div>

				</div>

				<div class="span3 sidebar padding accordion" id="accordion2">
					<!--
					<div class="row border-bottom">
						<div class="span3">
							<form id="search-form" action="/search">
								<input type="search" placeholder="Search" id="search" name="q" size="30" />
								<input class="btn gray_blue search" type="submit" value="Go" />
							</form>
						</div>
					</div>-->
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne"><h6><i class="accordion-icon icon-chevron-right"></i> Getting Started</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseOne" style="height: 0;">
						
							<div class="accordion-inner">
								
								<li><a href="/getting-started/jumpstarts" >Jumpstarts</a></li>
								
								<li><a href="/getting-started/af-cli" >AF Command Line Tool</a></li>
								
							</div>
						</ul>
					</div>
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
						<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo"><h6><i class="accordion-icon icon-chevron-right"></i> Frameworks</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseTwo" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/frameworks/node" >Node</a></li>
							
							<li><a href="/frameworks/php" >PHP</a></li>
							
							<li><a href="/frameworks/python" >Python</a></li>
							
							<li><a href="/frameworks/ruby" >Ruby</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree"><h6><i class="accordion-icon icon-chevron-right"></i> Services</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseThree" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/services/overview" >Overview</a></li>
							
							<li><a href="/services/tunneling" >Tunneling</a></li>
							
							<li><a href="/services/mysql" >MySQL</a></li>
							
							<li><a href="/services/mongodb" >MongoDB</a></li>
							
							<li><a href="/services/postgresql" >PostgreSQL</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseFour"><h6><i class="accordion-icon icon-chevron-down"></i> Add-ons</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse in" id="collapseFour" style="height: auto;">
						
							<div class="accordion-inner">
							
							<li><a href="/add-ons/searchify" >Searchify</a></li>
							
							<li><a href="/add-ons/mongolab" >MongoLab</a></li>
							
							<li><a href="/add-ons/mongohq" >MongoHQ</a></li>
							
							<li><a href="/add-ons/mailgun" >Mailgun</a></li>
							
							<li><a href="/add-ons/blitz" >Blitz</a></li>
							
							<li><a href="/add-ons/ironworker" >IronWorker</a></li>
							
							<li><a href="/add-ons/ironmq" >IronMQ</a></li>
							
							<li><a href="/add-ons/cloudmailin" >CloudMailin</a></li>
							
							<li><a href="/add-ons/cleardb" >ClearDB</a></li>
							
							<li><a href="/add-ons/memcachier" >MemCachier</a></li>
							
							<li><a href="/add-ons/statsmix" class="on">StatsMix</a></li>
							
							<li><a href="/add-ons/partners" >Add-on Partnership</a></li>
							
							</div>
						</ul>
					</div>

						<div class="row border-bottom"><div class="span3"><a href="/faq" ><h6>FAQ</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="http://console.appfog.com/pricing"><h6>Pricing</h6></a></div></div>
						<div class="row border-bottom"><div class="span3"><a href="/billing" ><h6>BILLING</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/troubleshooting" ><h6>Troubleshooting</h6></div></a></div>
						<!--<div class="row border-bottom"><div class="span3"><a href="/architecture" ><h6>Architecture</h6></div></a></div>-->
						<div class="row border-bottom"><div class="span3"><a href="/roadmap" ><h6>Feature Roadmap</h6></div></a></div>

					</div>
				</div>
			</div><!-- content -->
		</div><!-- container -->
	</div><!-- main_content -->

	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="span1">
					<img src="http://appfog.com/img/bydevfordev_95.png" width="95" height="79" alt="By Developers For Developers" id="badge">
				</div>
				<div class="span3">
					<h4>About AppFog</h4>
					<p>Easily build and deploy fast, scalable, and reliable applications to the cloud in seconds. Yeah, it’s that easy.</p>					
				</div>
				<div class="span2">
					<h4>Info</h4>
					<ul>
						<li><a href="http://appfog.com/support/">Support</a></li>
						<li><a href="https://appfog.com/about/">About</a></li>
						<li><a href="http://dev.appfog.com/">Documentation</a></li>
					</ul>
				</div>
				<div class="span2 offsettop">
					<ul>
						<li>Phone: 1.888.974.7364</li>
						<li>&copy; <script>document.write(new Date().getFullYear());</script> AppFog.</li>
						<li>All Rights Reserved.</li>
					</ul>
				</div>
				<div class="span4">
					<h4>Social</h4>
					<ul id="social">
						<li id="facebook"><a href="http://www.facebook.com/pages/AppFog/159333004147490">Facebook</a></li>
						<li id="twitter"><a href="https://twitter.com/#!/appfog">Twitter</a></li>
						<li id="linkedin"><a href="http://www.linkedin.com/company/appfog">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div> <!-- / .container -->
	</div>
	
	
<!-- scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://appfog.com/js/libs/jquery-1.7.1.min.js"><\/script>')</script>
<script src="http://appfog.com/js/plugins.js"></script>
<script src="http://appfog.com/js/script.js"></script>
<script type="text/javascript" src="/js/docs.js"></script>

</body>
</html>
