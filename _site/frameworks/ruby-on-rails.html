<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>AppFog &mdash; Documentation Ruby on Rails</title> 

		<link rel="stylesheet" href="http://appfog.com/css/style.css">
		<link href="/css/prettify.css" type="text/css" rel="stylesheet" />
		<link href="/css/table.css" rel="stylesheet">
		<link href="/css/docs.css" rel="stylesheet">
		<!-- typekit -->
		<script type="text/javascript" src="http://use.typekit.com/abw3xjt.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
				
		<!-- css -->

		<!-- modernizr -->
		<script src="http://appfog.com/js/libs/modernizr-2.5.3.min.js"></script>

		<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
		<script type="text/javascript" src="/js/bootstrap.js"></script>

		<!--  -->
		<link rel="icon" type="image/png" href="http://appfog.com/favicon.ico" />
	</head>
	<body id="blog" onload="prettyPrint()">
	<div id="header">
		<div class="container">
			<a href="http://appfog.com/" id="app_fog"><img src="http://appfog.com/img/app-fog.png" width="189" height="47" alt="App Fog"></a>
			<ul id="main_nav">
				<li id="nproducts">
					<a href="#" title="Products" class="parent"><span>Products</span></a>
					<ul>
						<li><a href="http://appfog.com/products/appfog">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog">PHP Fog</a></li>
					</ul>
				</li>
				<li id="npricing">
					<a href="#" title="Pricing" class="parent"><span>Pricing</span></a>
					<ul>
						<li><a href="https://console.appfog.com/pricing">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog/pricing/">PhpFog</a></li>
					</ul>
				</li>
				<li id="nshowcase"><a href="http://appfog.com/showcase/" title="Showcase">Showcase</a></li>
				<li id="nabout"><a href="http://appfog.com/about/" title="About">About</a></li>
				<li id="nsupport"><a href="http://appfog.com/support/" title="Support">Support</a></li>
				<li id="nblog"><a href="http://blog.appfog.com/" title="Blog">Blog</a></li>

				<li id="nlogin">
						  <a href="#" title="Log In" class="btn gray">Log In <i class="icon-chevron-down"></i></a>
						  <form id="log_in_form" class="dropdown">
							<div class="container">
							  <!-- <div class="half">
								<div class="radio_btn" id="log_in_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_php_fog" checked>
								  </span>
								  <label for="log_in_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="log_in_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_appfog">
								  </span>
								  <label for="log_in_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
							<!-- <hr> -->

							<!-- <div class="container appfog">
							  <input type="email" name="email" value="" id="appfog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="appfog_log_in_password" placeholder="Password" class="text">
							</div>
							
							<div class="container php_fog">
							  <input type="email" name="email" value="" id="php_fog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="php_fog_log_in_password" placeholder="Password" class="text">
							</div> -->
										

										
							<!-- <div class="container">  
							  <div class="half">
								<div class="checkbox">
								  <span class="active">
									<input type="checkbox" name="remember_me" value="" id="log_in_remember_me" checked>
								  </span>
								</div>
								<label for="log_in_remember_me" class="remember_me">Remember Me</label>
							  </div>

							  <div class="half forgot_password">
								<a href="#">Forgot Password?</a>
							  </div>
							</div> -->
										<a href="https://phpfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to PHP Fog</a>
										<hr>
										<a href="https://console.appfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to AppFog</a>
									</form>
								</li>
								<li id="nsignup">
									<a href="#" title="Sign Up" class="btn bright_green">Sign Up <i class="icon-chevron-down"></i></a>
									<form id="sign_up_form" class="dropdown">
							<!-- <div class="container">
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_php_fog" checked>
								  </span>
								  <label for="sign_up_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_appfog">
								  </span>
								  <label for="sign_up_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
										<!-- <hr>
													
													<div class="container php_fog">
													  <input type="email" name="email" value="" id="sign_up_php_fog_email" placeholder="Email" class="text">
													  <input type="password" name="password" value="" id="sign_up_password" placeholder="Password" class="text">
													  <input type="password" name="password_confirmation" value="" id="sign_up_password_confirmation" placeholder="Password Confirmation" class="text">
													</div>
													
													<div class="container appfog">
													  <input type="email" name="email" value="" id="sign_up_appfog_email" placeholder="Email" class="text">
													</div> -->
										
										<a href="https://phpfog.com/signup" class="btn bright_green submit" style="font-size: 13px;">Register for PHP Fog</a>
										<hr>
										<a href="http://appfog.com/signup.php" class="btn bright_green submit" style="font-size: 13px;">Register for AppFog</a>
									</form>
								</li>

			</ul>
		</div> 
	</div>
	<div id="main_content">
		<div class='container'>

			
			<div id="top_bar" class="row gray_blue margin_bottom">
				<div class="span12">
					<a href="/"><h1 class="title">AppFog Docs</h1></a>
					<ul id="docs_nav">
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="/frameworks">Frameworks</a></li>
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="#">Ruby on Rails</a></li>
					</ul>
					<ul id="secondary_nav">
						<li><a href="http://docs.phpfog.com">PHP Fog Docs</a></li>
					</ul>
				</div>

			</div>
			
					


			<div id="content" class="row white">
				<div class="span8 main_content">
					<div class="row entries">
	<div class="span8">
		<div class="row">
			<div class="span8">
				<h1>Ruby on Rails</h1>
				<ul>
  <li><a href="#rubyversions">Supported Ruby Versions</a></li>
  <li><a href="#gems">Gems and Gemfiles</a></li>
  <li><a href="#bundler">Bundler</a></li>
  <li><a href="#rails30">Rails 3.0</a></li>
  <li><a href="#rails31">Rails 3.1</a></li>
  <li><a href="#autoreconfig">Auto-reconfiguration</a></li>
</ul>

<h3 id="rubyversions">Supported Ruby Versions</h3>

<p>AppFog supports:</p>

<ul>
  <li>Ruby 1.8.7-p302 or higher</li>
  <li>Ruby 1.9.2-p174 or higher </li>
</ul>

<p>Ruby 1.8.7 is the default. </p>

<p>To use Ruby 1.9.2, add the <code>af  --runtime ruby19</code> option when you push your code:</p>

<pre class="prettyprint"><code>$ af push &lt;appname&gt; --runtime ruby19
</code></pre>

<h1 id="gems">Gems and Gemfiles</h1>

<p>AppFog requires a <code>Gemfile</code> in your app’s root directory. This should list the gems your app needs to run. </p>

<p>The following Gemfile feature aren’t supported yet: </p>

<ul>
  <li>gem dependencies on git <code>URL</code>s or branches</li>
  <li>gem :path =&gt; “some/path”</li>
  <li>platform-conditional gems</li>
</ul>

<p>AppFog currently only offers one app server for Sinatra and Rails apps: Thin. If you’re using Bundler, and nothing in your app’s bundle requires Thin, VCAP cannot safely start your app using it. In such cases, it will fall back to running your app using ‘<code>rails server</code>’, which uses WEBrick. For best performance and results, use Thin.</p>

<h1 id="bundler">Bundler</h1>

<p>You should use <a href="http://gembundler.com/">Bundler</a> to package your apps. Run <code>bundle package; bundle install</code> each time you modify your Gemfile and before you make an <code>af push </code> or <code>af update</code> command.</p>

<h3 id="gems-with-known-issues">Gems with known issues:</h3>

<ul>
  <li>rmagick (requires http://www.imagemagick.org/script/index.php native library to be installed)</li>
</ul>

<p><a href="https://github.com/jbarnette/isolate">Isolate</a> is not well-supported on AppFog.</p>

<h1 id="rails30">Rails 3.0</h1>

<p>Ruby on Rails app deployments on AppFog automatically recognize MySQL. For other services, you’ll need to access the <code>VCAP_SERVICES</code> environment variable. More on that in our <a href="/services">Services doc</a>.</p>

<p>Make sure to use the correct version of the MySQL2 gem in your Gemfile:</p>

<pre class="prettyprint linenums"><code># If you use a different database in development, hide it from AppFog
group :development do
gem 'sqlite3'
end

# Rails 3.0 requires version less than 0.3 of mysql2 gem
group :production do
gem 'mysql2', '&lt; 0.3'
end
</code></pre>

<h3 id="bundle-your-app">Bundle your app:</h3>

<pre class="prettyprint"><code>$ bundle package
$ bundle install
</code></pre>

<p>Deploy:</p>

<pre class="prettyprint"><code>$ af push
</code></pre>

<h1 id="rails31">Rails 3.1</h1>

<p>Rails 3.1 introduces the asset pipeline. To get the asset pipeline working on AppFog, precompile your assets in your development environment. This compiles them into <code>public/assets</code>, at which point you can tweak the production environment configuration before excuting a normal <code>af push</code>.</p>

<h3 id="gemfile">Gemfile</h3>

<h4 id="ruby-18">Ruby 1.8</h4>

<pre class="prettyprint linenums"><code># If you use a different database in development, hide it from AppFog.
group :development do
gem 'sqlite3'
end

# Rails 3.1 can use the latest mysql2 gem.
group :production do
gem 'mysql2'
end
</code></pre>

<h4 id="ruby-19">Ruby 1.9</h4>

<pre class="prettyprint linenums"><code># If you use a different database in development, hide it from AppFog.
group :development do
gem 'sqlite3'
end

# Rails 3.1 can use the latest mysql2 gem.
group :production do
gem 'mysql2'
end

# For Ruby 1.9 AppFog requires a tweak to the jquery-rails gem.
# gem 'jquery-rails'
gem 'cloudfoundry-jquery-rails'

# For Ruby 1.9 AppFog requires a tweak to devise.
# Uncomment next line if you plan to use devise.
# gem 'cloudfoundry-devise', :require =&gt; 'devise'
</code></pre>

<h3 id="bundle-your-app-1">Bundle your app:</h3>

<pre class="prettyprint"><code>$ bundle package
$ bundle install
</code></pre>

<h3 id="configs">Configs</h3>

<p>In <code>config/environments/production.rb</code>, change</p>

<pre class="prettyprint"><code>config.server_static_assets = false
</code></pre>

<p>to</p>

<pre class="prettyprint"><code>config.server_static_assets = true
</code></pre>

<h3 id="assets">Assets</h3>

<p>Pre-compile your asset pipeline:</p>

<pre class="prettyprint"><code>$ bundle exec rake assets:precompile
</code></pre>

<h3 id="version-control-system">Version Control System</h3>

<p>Commit the current configuration to your version control system. Consider including: + <code>Gemfile.lock</code> + gems packaged into <code>vendor/cache</code> + assets compiled into <code>public/assets</code>.</p>

<h3 id="deploy">Deploy</h3>

<pre class="prettyprint"><code>$ af push
</code></pre>

<h1 id="autoreconfig">Auto-reconfiguration</h1>

<p>Ruby on Rails apps deployed on AppFog support auto-reconfiguration for relational database services. This means you can deploy a Rails app on AppFog without changing a single line of code. </p>

<p>AppFog automatically reconfigures Rails apps by modifying the production settings in your <code>config/database.yml</code> file during staging.</p>

<p>While it’s fairly common to put these types of connections in a Rails Initializer File, auto-reconfiguration should work just as well if you create the connection somewhere else within your application.</p>

<p>When your Rails app is staged for deployment, AppFog makes two modifications:</p>

<ul>
  <li>Adds an additional <code>cf-autoconfig</code> gem to your Bundle.</li>
  <li>Adds an Initializer file to <code>config/initializers</code> that ensures that all dynamic class modification is done prior to loading other Initializers (and thus before your app executes).</li>
</ul>

<h3 id="limitations">Limitations</h3>

<p>Auto-reconfiguration only works if there’s exactly one service of a given service type bound to your app. For example, you can only bind only one relational database service (e.g. MySQL or Postgres) to an app. </p>

<p>If your app doesn’t follow these limitations, AppFog won’t auto-reconfigure your app. </p>

<p>The auto-reconfiguration mechanism also expects typical Ruby apps. If your app configuration is complex, it may not work. In those cases, you can opt out of auto-reconfiguration:</p>

<h3 id="opting-out-of-auto-reconfiguration">Opting out of auto-reconfiguration</h3>

<p>AppFog offers a few ways to opt out of the auto-reconfiguration mechanism.</p>

<ul>
  <li>Create a file in your Rails app called <code>config/cloudfoundry.yml</code>. Add the entry <code>autoconfig: false</code>.</li>
  <li>Include the <code>cf-runtime</code> gem in your app’s <code>Gemfile</code>. </li>
</ul>

<p>For more technical details about how auto-reconfiguration works on Cloud Foundry, check out <a href="http://blog.cloudfoundry.com/2012/03/12/using-cloud-foundry-services-with-ruby-part-1-auto-reconfiguration/">this blog post</a>.</p>


			</div>
		</div>
	</div>
</div>

				</div>

				<div class="span3 sidebar padding accordion" id="accordion2">
					<!--
					<div class="row border-bottom">
						<div class="span3">
							<form id="search-form" action="/search">
								<input type="search" placeholder="Search" id="search" name="q" size="30" />
								<input class="btn gray_blue search" type="submit" value="Go" />
							</form>
						</div>
					</div>-->
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne"><h6><i class="accordion-icon icon-chevron-right"></i> Getting Started</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseOne" style="height: 0;">
						
							<div class="accordion-inner">
								
								<li><a href="/getting-started/jumpstarts" >Jumpstarts</a></li>
								
								<li><a href="/getting-started/app-console" >App Console</a></li>
								
								<li><a href="/getting-started/af-cli" >AF Command Line Tool</a></li>
								
							</div>
						</ul>
					</div>
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
						<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo"><h6><i class="accordion-icon icon-chevron-down"></i> Frameworks</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse in" id="collapseTwo" style="height: auto;">
						
							<div class="accordion-inner">
							
							<li><a href="/frameworks/java" >Java</a></li>
							
							<li><a href="/frameworks/java-grails" >Java Grails</a></li>
							
							<li><a href="/frameworks/java-spring-mysql" >Java Spring</a></li>
							
							<li><a href="/frameworks/node" >Node</a></li>
							
							<li><a href="/frameworks/node-chat" >Node Chat</a></li>
							
							<li><a href="/frameworks/node-express" >Node Express</a></li>
							
							<li><a href="/frameworks/php" >PHP</a></li>
							
							<li><a href="/frameworks/php-drupal" >Drupal</a></li>
							
							<li><a href="/frameworks/php-wordpress" >WordPress</a></li>
							
							<li><a href="/frameworks/python" >Python</a></li>
							
							<li><a href="/frameworks/python-django" >Python Django</a></li>
							
							<li><a href="/frameworks/python-flask" >Python Flask</a></li>
							
							<li><a href="/frameworks/ruby-sinatra" >Ruby Sinatra</a></li>
							
							<li><a href="/frameworks/ruby-on-rails" class="on">Ruby on Rails</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree"><h6><i class="accordion-icon icon-chevron-right"></i> Services</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseThree" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/services/overview" >Overview</a></li>
							
							<li><a href="/services/mysql" >MySQL</a></li>
							
							<li><a href="/services/mongodb" >MongoDB</a></li>
							
							</div>
						</ul>
					</div>

						<div class="row border-bottom"><div class="span3"><a href="/faqs" ><h6>FAQ</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="http://console.appfog.com/pricing"><h6>Pricing</h6></a></div></div>
						<div class="row border-bottom"><div class="span3"><a href="/troubleshooting" ><h6>Troubleshooting</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/architecture" ><h6>Architecture</h6></div></a></div>

					</div>
				</div>
			</div><!-- content -->
		</div><!-- container -->
	</div><!-- main_content -->

	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="span1">
					<img src="http://appfog.com/img/bydevfordev_95.png" width="95" height="79" alt="By Developers For Developers" id="badge">
				</div>
				<div class="span3">
					<h4>About AppFog</h4>
					<p>Easily build and deploy fast, scalable, and reliable applications to the cloud in seconds. Yeah, it’s that easy.</p>					
				</div>
				<div class="span2">
					<h4>Info</h4>
					<ul>
						<li><a href="http://appfog.com/support/">Support</a></li>
						<li><a href="https://appfog.com/about/">About</a></li>
						<li><a href="http://dev.appfog.com/">Documentation</a></li>
					</ul>
				</div>
				<div class="span2 offsettop">
					<ul>
						<li>Phone: 1.888.974.7364</li>
						<li>&copy; <script>document.write(new Date().getFullYear());</script> AppFog.</li>
						<li>All Rights Reserved.</li>
					</ul>
				</div>
				<div class="span4">
					<h4>Social</h4>
					<ul id="social">
						<li id="facebook"><a href="http://www.facebook.com/pages/AppFog/159333004147490">Facebook</a></li>
						<li id="twitter"><a href="https://twitter.com/#!/appfog">Twitter</a></li>
						<li id="linkedin"><a href="http://www.linkedin.com/company/appfog">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div> <!-- / .container -->
	</div>
	
	
<!-- scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://appfog.com/js/libs/jquery-1.7.1.min.js"><\/script>')</script>
<script src="http://appfog.com/js/plugins.js"></script>
<script src="http://appfog.com/js/script.js"></script>
<script type="text/javascript" src="/js/docs.js"></script>

</body>
</html>
